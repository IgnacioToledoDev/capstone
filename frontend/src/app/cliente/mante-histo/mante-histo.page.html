<ion-header>
  <ion-icon name="arrow-back-outline" class="back-button" fill="clear" (click)="goBack()"></ion-icon>
  <ion-title class="title_1">Historial</ion-title>
  <br><br>
</ion-header>

<ion-content [fullscreen]="true">
  <br><br>
  <ion-card>
    <ion-card-header>
      <ion-card-title>Lista de Mantenciones</ion-card-title>
    </ion-card-header>
    <ion-searchbar class="input-item" placeholder="Buscar Mantención..." (ionInput)="filterMaintenance($event)"></ion-searchbar>
    <ion-card-content class="info-card">
      <ion-list>
        <ion-item *ngFor="let maintenance of filteredMaintenances" (click)="saveMaintenanceToStorage(maintenance)">
          <ion-label class="client-details">
            <h2>{{ maintenance.car.brand }} {{ maintenance.car.model }} ({{ maintenance.car.year }})</h2>
            <ion-card-subtitle>{{ maintenance.car.patent }}</ion-card-subtitle>
            <p>Precio: {{ maintenance.maintenance?.pricing | currency }}</p>
            <p>Mecánico: {{ maintenance.mechanic?.name }}</p>
            <p>Estado Mantesion:
              <!-- Mostrar "En espera" si la fecha es null y el estado es 0 -->
              <span *ngIf="maintenance.maintenance?.status_id === 1" name="time-outline" color="medium">Inactivo</span>
              <span *ngIf="maintenance.maintenance?.status_id === 2" name="time-outline" color="medium">Comenzando</span>

              <span *ngIf="maintenance.maintenance?.status_id === 1" name="time-outline" color="medium">...En espera</span>

              <span *ngIf="maintenance.maintenance?.status_id === 1" name="time-outline" color="medium">Finalizado</span>


            </p>
            <p>Estado: {{ maintenance.maintenance?.status_id === 3 ? 'Finalizado' : 'En Proceso' }}</p>
            <p>Fecha de Inicio: {{ maintenance.maintenance?.start_maintenance | date: 'short' }}</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>
</ion-content>

<ion-footer>
  <div class="button-container">
    <ion-button class="custom-button" expand="full" routerLink="/cliente/home-cliente">
      <ion-icon slot="start" name="home"></ion-icon>
      Inicio
    </ion-button>
    <ion-button class="custom-button" expand="block" routerLink="/mecanico/ajustes">
      <ion-icon slot="start" name="settings"></ion-icon>
      Ajustes
    </ion-button>
  </div>
</ion-footer>
